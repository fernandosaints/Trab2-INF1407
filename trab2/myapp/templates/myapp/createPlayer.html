{% load static %}
<!DOCTYPE html>
<html>

<head>
  <title>Cria Jogador</title>
  <link rel="stylesheet" href="{% static 'myapp/css/style.css' %}">
</head>
{% block javascript %}
<script type="text/javascript">
  onload = function () {
    document.getElementById('id_username').addEventListener('keyup', function (e) {
      var campoUsername = document.getElementById('id_username');
      var xmlhttp = new XMLHttpRequest();
      xmlhttp.open("GET", "{% url 'verificaUsername' %}?username=" + encodeURIComponent(campoUsername.value), true);
      xmlhttp.onreadystatechange = function () {
        if (xmlhttp.status == 200 && xmlhttp.readyState == 4) {
          var resposta = JSON.parse(xmlhttp.responseText);
          if (resposta.existe) {
            campoUsername.style = "border: 1px solid #FF0000";
            document.getElementById('idMsgErro').replaceChild(document.createTextNode("Usuário já existe"), document.getElementById('idMsgErro').firstChild);
          }
          else {
            campoUsername.style = "border: 1px solid #00FF00";
            document.getElementById('idMsgErro').replaceChild(document.createTextNode("OK"), document.getElementById('idMsgErro').firstChild);
          }
        }
      };
      xmlhttp.send(null);
    });
  }
</script>
{% endblock %}

<body>
  {% include 'myapp/links.html' %}
  <h1>Cria um jogador</h1>
  <h6>createPlayer.html</h6>
  <form action="" method="POST">
    {% csrf_token %}
    <table class='formulario'>
      {{ formulario.as_table}}
    </table>
    <button type="submit">Cria jogador</button>
  </form>
</body>

</html>